FROM node:latest

WORKDIR /home/source
COPY . .

RUN apt update && apt -y install nginx &&  \
    npm install -g pnpm && pnpm install && pnpm run build_profile

RUN mv -f ./packages/profile/default /etc/nginx/sites-available

EXPOSE 82

CMD ["nginx", "-g", "daemon off;"]